jQuery(function($){$(document).on('submit','#comment-form',function(event){event.preventDefault();var $this=$(this);var request={'option':'com_product','view':'products','task':'add_comment','text':$('#comment_text').val(),'product_id':$('#product_id').val(),'g-recaptcha-response':$('#g-recaptcha-response').val()};$.ajax({type:'POST',data:request,success:function(response){var data=$.parseJSON(response);if(data.status){$(data.content).appendTo($('#comments')).hide().fadeIn();$('#comment_text').val('');$('.comment-status').removeClass('alert alert-danger').addClass('alert alert-success').text(data.message);setTimeout(function(){$('.comment-status').html('').removeClass('alert alert-success');},1500);var request_alt={'option':'com_product','view':'products','task':'comment_notification','product_id':data.product_id,'comment_id':data.comment_id};$.ajax({type:'POST',data:request_alt});}else{$('.comment-status').removeClass('alert alert-success').addClass('alert alert-danger').text(data.message);}
if($('#dynamic_recaptcha').length){var recaptchaframe=$('#dynamic_recaptcha iframe');var recaptchaSoure=recaptchaframe[0].src;recaptchaframe[0].src='';setInterval(function(){recaptchaframe[0].src=recaptchaSoure;},500);}}});return false;});$(document).on('click','.remove-comment',function(event){event.preventDefault();var $this=$(this);var request={'option':'com_product','view':'products','task':'remove_comment','comment_id':$this.data('comment_id')};if(confirm('Are you sure to remove this comment?')){$.ajax({type:'POST',data:request,success:function(response){if(response){$this.closest('.comment').animate({height:0,opacity:0},300,function(event){$(this).remove();});}else{alert('Something went wrong!');}}});}});$(document).on('click','.btn-comment-reply',function(event){event.preventDefault();$('#reply-form').remove();var $this=$(this);var product_id=$this.closest('.comment').attr('id').split('-');var form_html='<form action="" id="reply-form">';form_html+='<div class="form-group">';form_html+='<textarea name="reply_text" id="reply_text" class="form-control" minlength="2" required="required" placeholder="Reply Comment"></textarea>';form_html+='</div>';form_html+='<input type="hidden" id="reply_product_id" name="reply_product_id" value="'+ product_id[0]+'">';form_html+='<input type="hidden" id="reply_parent_id" name="reply_parent_id" value="'+ product_id[1]+'">';form_html+='<button class="btn btn-success" type="submit">Submit</button> <a href="#" id="cancel-reply" class="btn btn-danger">Cancel</a>';form_html+='</form>';$(form_html).appendTo($this.closest('.comment'));$('#reply_text').focus();});$(document).on('click','#cancel-reply',function(event){event.preventDefault();$('#reply-form').remove();});$(document).on('submit','#reply-form',function(event){event.preventDefault();var $this=$(this);var request={'option':'com_product','view':'products','task':'add_reply','reply_text':$('#reply_text').val(),'reply_product_id':$('#reply_product_id').val(),'reply_parent_id':$('#reply_parent_id').val()};$.ajax({type:'POST',data:request,success:function(response){var data=$.parseJSON(response);if(data.status){$(data.content).appendTo($this.closest('.comment').find('.comment-replies'));$('#reply_text').val('');var request_alt={'option':'com_product','view':'products','task':'reply_notification','product_id':data.product_id,'comment_id':data.comment_id};$.ajax({type:'POST',data:request_alt});}else{alert('Oops, Something went wrong.');}}});return false;});$(document).on('keyup','textarea',function(){adaptiveheight(this);});function adaptiveheight(a){var i=0;var j=0;$(a).height(0);var scrollval=$(a)[0].scrollHeight;$(a).height(scrollval);if(parseInt(a.style.height)>$(window).height()){if(j==0){max=a.selectionEnd;}
j++;var i=a.selectionEnd;console.log(i);if(i>=max){$(document).scrollTop(parseInt(a.style.height));}else{$(document).scrollTop(0);}}}
$(document).on('click','.remove-reply',function(event){event.preventDefault();var $this=$(this);var request={'option':'com_product','view':'products','task':'remove_reply','comment_id':$this.data('reply_id')};if(confirm('Are you sure to remove this reply?')){$.ajax({type:'POST',data:request,success:function(response){if(response){$this.closest('.comment-reply').fadeOut(300,function(){$(this).remove()});}}});}});$(document).on('click','.report-reply',function(event){event.preventDefault();var $this=$(this);$('#report-reply-outer').remove();var form_html='<div id="report-reply-outer"><p class="text-danger">If you find this reply offensive to you, please submit a report here.</p>';form_html+='<form action="" id="report-form">';form_html+='<div class="form-group">';form_html+='<textarea name="report_text" id="report_text" class="form-control" minlength="2" required="required"></textarea>';form_html+='</div>';form_html+='<input type="hidden" name="reply_id" id="reply_id" value="'+ $this.data('reply_id')+'">';form_html+='<button class="btn btn-warning" type="submit">Report</button> <a href="#" id="cancel-report" class="btn btn-link">Cancel</a>';form_html+='</form></div>';$(form_html).appendTo($this.closest('.media-body'));$('#report_text').focus();});$(document).on('click','#cancel-report',function(event){event.preventDefault();$('#report-reply-outer').remove();});$(document).on('submit','#report-form',function(event){event.preventDefault();var $this=$(this);var data=$(this).serializeArray();var request={'option':'com_product','view':'products','task':'report_comment','comment_text':$this.closest('.comment-reply').find('.comment-text').text(),'data':data};$.ajax({type:'POST',data:request,success:function(response){$('#report-reply-outer').remove();alert('Your report have been submitted to the site administrator');}});});});